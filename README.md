# SingleStore Demo: S2Cellular

In this demo, we simulate an important workload of a hypothetical cellular data company. The workload ingests device data in order to serve hyper-local sponsored offers to subscribers.

# Simulator

The simulator is written in Golang. Internally it is modular, allowing it to output data in multiple formats to different backends. The recommended production outputter is S3/Parquet.

The simulator takes in a config file documented in `config.example.toml`. This file controls the parameters of the simulation.

Data generated by the simulator is designed to be loaded repeatedly to simulate device streams coming from many different locations over time. To help achieve this, timestamps are not included in the generated data and location is output as coordinates on the unit circle (centered at `[0,0]`)

## gen

The `gen` package is responsible for generating the data. It has a driver which leverages many concurrent goroutines to iterate through all of the subscribers as fast as possible.

## output

The `output` package is responsible for encoding and uploading the data to a target. The primary interface it exposes is `output.Writer`. The output package supports the following encodings/output targets:

* Encodings
    * Parquet
    * JSON
* Targets
    * S3
    * Local filesystem

More targets can be added in the future.

# Stored Procedures

This demo makes extensive use of stored procedures which contain all of the logic required to load the data and match subscribers to offers.

Matching is performed in a stored procedure attached to the locations pipelines. This ensures that we are matching subscribers to offers as soon as we receive a location update.

# User Interface

The user interface is implemented as a single-page web application which runs entirely in the browser. The interface connects to any SingleStore database which has the HTTP API enabled, thus the interface can be accessed through a static URL for very little cost.

On load, the interface requests connection information to SingleStore. It will initialize the schema if not already initialized.